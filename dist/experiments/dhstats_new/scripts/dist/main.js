var DHStats;DHStats=(()=>{var e={85:function(e,t,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,i=s.length;o<i;o++,a++)n[a]=s[o];return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Analyse=void 0;var s=r(675),o=a(r(293)),i=r(40),u=a(r(945)),c=r(46),l=function(){function e(e){this.meta=e.meta,this.data=e.data}return e.prototype.analyse=function(){var e=new Array,t=Date.now();for(var r in console.log("Analysing..."),this.data)if(Object.prototype.hasOwnProperty.call(this.data,r)){var n=this.data[r],a=c.WorkerPromise("//workers/Worker.js",{meta:this.meta,channelData:n,channelId:r});e.push(a)}return Promise.all(e).then((function(e){return console.log("Done! Analyse took "+(Date.now()-t)/1e3+" seconds."),e}))},e.prototype.statsToXLSX=function(e){console.log("Generating excel file...");var t=new o.default({Title:"DHStats",Subject:"Discord History Statistics",Author:"Me",CreatedDate:new Date(Date.now())}),r=n(["date"],Object.keys(i.initStatsObject()),["word","word_occurrence","hour","messages_per_hour"]);e.sort((function(e,t){return t.stats[t.stats.length-1][1].total-e.stats[e.stats.length-1][1].total}));for(var a=new Map,c={},l={},f=0,h=e;f<h.length;f++){var d=h[f];for(var p in d.stats){var v=d.stats[p],g=a.get(v[0])||i.initStatsObject();a.set(v[0],s.SumObjects(g,v[1]))}c=s.SumObjects(c,Object.fromEntries(d.words)),l=s.SumObjects(l,Object.fromEntries(d.hours))}var m=s.CreateSheetData(u.default.sumStats(a),Object.entries(c).sort((function(e,t){return t[1]-e[1]})),Object.entries(l).sort((function(e,t){return e[0]-t[0]})));t.addSheet("Global statistics",n([r],m));var b=new Map;for(var p in a){for(var y=a.get(p),S=b.get(parseInt(p))||{Male:0,Female:0,Other:0,Unknown:0},w=0,O=y.recipients;w<O.length;w++){var _=O[w];S[this.meta.users[this.meta.userindex[_]].gender||"Unknown"]++}b.set(parseInt(p),S)}t.addSheet("Recipients per gender",n([["Date","Male","Female","Other","Unknown"]],s.CreateSingleSheetData(Array.from(b).sort((function(e,t){return e[0]-t[0]})))));for(var j=new Map,D=0,M=e;D<M.length;D++)for(var p in(d=M[D]).userStats){v=d.userStats[p];var k=j.get(v[0])||{Male:0,Female:0,Other:0,Unknown:0};for(var _ in v[1])if(v[1].hasOwnProperty(_)){var P=v[1][_];k[this.meta.users[this.meta.userindex[_]].gender||"Unknown"]+=P}j.set(v[0],k)}t.addSheet("Messages per gender",n([["Date","Male","Female","Other","Unknown"]],s.CreateSingleSheetData(Array.from(j).sort((function(e,t){return e[0]-t[0]})))));for(var x=0,A=e;x<A.length;x++){d=A[x];var C=this.meta.channels[d.id].name.replace(/[\\/\?\*\[\]]/g,""),T=s.CreateSheetData(d.stats,d.words,d.hours);t.addSheet(C,n([r],T))}return console.log("Saving file..."),t.save("dhstats")},e}();t.Analyse=l},945:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(40),a=r(675),s=function(){function e(e,t){this.meta=e,this.data=t,this.dayStats=[],this.words=[],this.hours=[],this.userStats=[]}return e.sumStats=function(e){for(var t=Array.from(e).sort((function(e,t){return e[0]-t[0]})),r=0;r<t.length;r++)if(void 0!==t[r][1]){var n=t[r][1],a=0,s=0;r>0&&(a=t[r-1][1].total,s=t[r-1][1].total_embeds),t[r][1].total=a+n.messages;var o=Object.values(n.embeds),i=0;o.length>0&&(i=o.reduce((function(e,t){return e+t}))),t[r][1].total_embeds=s+i}return t},e.prototype.dailyStats=function(){var t=new Map,r=new Map,s=new Map,o=new Map;if(void 0!==this.data){var i=function(e){if(void 0===u.data[e])return"continue";var i=u.data[e],c=new Date(i.t),l=a.padZeros(c.getHours(),2)+":"+a.padZeros(c.getMinutes(),2);o.set(l,(o.get(l)||0)+1),c.setHours(0,0,0,0);var f=i.m,h=i.e||null,d=Object.assign(u.meta.users[u.meta.userindex[i.u]],{id:u.meta.userindex[i.u],index:i.u}),p=t.get(c.getTime())||n.initStatsObject();p.messages++,null!==h&&h.forEach((function(e){p.embeds[e.type]=p.embeds[e.type]||0,p.embeds[e.type]++})),p.recipients.includes(d.index)||p.recipients.push(d.index),t.set(c.getTime(),p),void 0!==f&&f.toLowerCase().split(/\s/gi).map((function(e){return e.trim()})).filter((function(e){return e.length>0})).forEach((function(e){s.set(e,(s.get(e)||0)+1)}));var v=r.get(c.getTime())||{};v[d.index]=(v[d.index]||0)+1,r.set(c.getTime(),v)},u=this;for(var c in this.data)i(c);var l=new Date(Date.now()).setHours(0,0,0,0);t.has(l)||t.set(l,n.initStatsObject()),this.dayStats=e.sumStats(t),this.words=Array.from(s).sort((function(e,t){return t[1]-e[1]})).filter((function(e){return e[1]>100})),this.hours=Array.from(o).sort((function(e,t){return e[0].localeCompare(t[0])})),this.userStats=Array.from(r).sort((function(e,t){return e[0]-t[0]}))}},e}();t.default=s},293:function(e,t,r){"use strict";var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),s=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});var o=s(r(869)),i=function(){function e(e){this.wb=o.utils.book_new(),this.wb.Props=e}return e.prototype.addSheet=function(e,t){var r;this.wb.SheetNames.push(e),r=t instanceof Array?o.utils.aoa_to_sheet(t):t,this.wb.Sheets[e]=r},e.prototype.save=function(e){return o.write(this.wb,{bookType:"xlsx",type:"binary"})},e}();t.default=i},675:function(e,t,r){"use strict";var n=this&&this.__spreadArrays||function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var s=arguments[t],o=0,i=s.length;o<i;o++,a++)n[a]=s[o];return n},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.padZeros=t.CreateSheetData=t.CreateSingleSheetData=t.sVerticalPush=t.verticalPush=t.SumObjects=void 0;var s=a(r(116));function o(e,t){for(var r,n=0,a=0;a<t.length;a++)void 0===e[a]&&(e[a]=new Array(n)),n=e[a].length,(r=e[a]).push.apply(r,t[a]);return e}function i(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=e.length-1;r>0;r--)e[r-1]=o(e[r-1],e[r]);return e[0]}function u(e){return e.map((function(e){var t=Object.values(e[1]).map((function(e){switch(typeof e){case"object":return e instanceof Array?e.length:Object.keys(e).length>0?Object.values(e).reduce((function(e,t){return e+t})):0;default:return e}}));return n([s.default(e[0],"yyyy-mm-dd")],t)}))}t.SumObjects=function e(t,r,n){void 0===n&&(n=!1);for(var a=[],s=0,o=Object.keys(t).concat(Object.keys(r));s<o.length;s++){var i=o[s];a.includes(i)||a.push(i)}for(var u=function(n){switch(void 0!==t[n]?typeof t[n]:typeof r[n]){case"number":case"bigint":case"string":void 0!==t[n]&&void 0!==r[n]?t[n]=t[n]+r[n]:void 0!==r[n]?t[n]=r[n]:void 0!==t[n]?t[n]=t[n]:t[n]=0;break;case"object":t[n]instanceof Array?r[n].forEach((function(e){t[n].includes(e)||t[n].push(e)})):t[n]=e(t[n],r[n])}},c=0,l=a;c<l.length;c++)u(l[c]);return t},t.verticalPush=o,t.sVerticalPush=i,t.CreateSingleSheetData=u,t.CreateSheetData=function(e,t,r){return 0===t.length&&(t=[["",""]]),i(u(e),t,r)},t.padZeros=function(e,t){return e.toString().padStart(t,"0")}},46:function(e,t,r){"use strict";var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerPromise=void 0;var a=n(r(580));t.WorkerPromise=function(e,t){return new Promise((function(e,r){var n=new a.default;n.postMessage(t),n.onmessage=function(t){e(t.data),n.terminate()},n.onerror=function(){return r}}))}},40:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStatsObject=void 0,t.initStatsObject=function(){return{messages:0,embeds:{},total:0,recipients:[],total_embeds:0}}},580:(e,t,r)=>{"use strict";function n(){return new Worker(r.p+"WorkerWeb.worker.js")}r.r(t),r.d(t,{default:()=>n})},906:()=>{},993:()=>{},791:()=>{}},t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={exports:{}};return e[n].call(a.exports,a,a.exports,r),a.exports}return r.m=e,r.x=e=>{},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;r.g.importScripts&&(e=r.g.location+"");var t=r.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");n.length&&(e=n[n.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),r.p=e})(),(()=>{var e={179:0},t=[[85,171]],n=e=>{},a=(a,s)=>{for(var o,i,[u,c,l,f]=s,h=0,d=[];h<u.length;h++)i=u[h],r.o(e,i)&&e[i]&&d.push(e[i][0]),e[i]=0;for(o in c)r.o(c,o)&&(r.m[o]=c[o]);for(l&&l(r),a&&a(s);d.length;)d.shift()();return f&&t.push.apply(t,f),n()},s=self.webpackChunkDHStats=self.webpackChunkDHStats||[];function o(){for(var n,a=0;a<t.length;a++){for(var s=t[a],o=!0,i=1;i<s.length;i++){var u=s[i];0!==e[u]&&(o=!1)}o&&(t.splice(a--,1),n=r(r.s=s[0]))}return 0===t.length&&(r.x(),r.x=e=>{}),n}s.forEach(a.bind(null,0)),s.push=a.bind(null,s.push.bind(s));var i=r.x;r.x=()=>(r.x=i||(e=>{}),(n=o)())})(),r.x()})();